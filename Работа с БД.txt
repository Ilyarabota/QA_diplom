1
SELECT Couriers.login,
       COUNT(Orders.courierId) AS orders_in_delivery
FROM Orders
INNER JOIN Couriers ON Orders.courierId = Couriers.id
WHERE Orders.inDelivery = TRUE
GROUP BY Couriers.login;
2
SELECT track,
       CASE
           WHEN finished THEN 2
           WHEN cancelled THEN -1
           WHEN inDelivery THEN 1
           ELSE 0
       END AS status
FROM Orders;